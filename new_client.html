<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Keep this page out of Google -->
  <meta name="robots" content="noindex, nofollow" />

  <title>New Client Form</title>

  <!-- Your existing site CSS -->
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div id="main-content" style="opacity: 1;">
    <div class="single-column">
      <div class="text-content active">
        <h1>New Client Form</h1>

        <p>
          This form helps me gather everything needed to scope your project accurately. After I review your
          responses, Iâ€™ll confirm final pricing (if anything changes) and send your first Stripe invoice.
          Work begins after payment.
        </p>

        <form id="intake-form" class="contact-form" novalidate>
          <input type="hidden" name="_subject" value="New Client Intake Submission" />
          <input type="text" name="_gotcha" style="display:none" tabindex="-1" autocomplete="off" />

          <h3>Primary Contact</h3>

          <label for="contact_name">Name:</label>
          <input type="text" id="contact_name" name="contact_name" required autocomplete="name" />

          <label for="contact_phone">Phone Number (for contact):</label>
          <input type="tel" id="contact_phone" name="contact_phone" required autocomplete="tel" />

          <label for="contact_email">Email (for contact):</label>
          <input type="email" id="contact_email" name="contact_email" required autocomplete="email" />

          <h3>Business Info</h3>

          <label for="business_name">Business Name:</label>
          <input type="text" id="business_name" name="business_name" required autocomplete="organization" />

          <label for="site_phone">Phone Number (to display on site):</label>
          <input type="tel" id="site_phone" name="site_phone" placeholder="If different from contact phone" />

          <label for="site_email">Email (to display on site):</label>
          <input type="email" id="site_email" name="site_email" placeholder="If different from contact email" />

          <label for="business_address">Business Address (if applicable):</label>
          <input type="text" id="business_address" name="business_address" autocomplete="street-address" />

          <h3>About / Copy</h3>

          <label for="about_you">About you / your business (I can paraphrase or write polished copy from this):</label>
          <textarea id="about_you" name="about_you" rows="6" required></textarea>

          <h3>Socials</h3>

          <label for="social_links">Social links (paste any that apply):</label>
          <textarea id="social_links" name="social_links" rows="4" placeholder="Instagram, Facebook, TikTok, YouTube, LinkedIn, etc."></textarea>

          <h3>People to Mention</h3>

          <label for="co_owners">Co-Owners (if any):</label>
          <textarea id="co_owners" name="co_owners" rows="2" placeholder="Names + titles (optional)"></textarea>

          <label for="other_people">Other people that should be mentioned (if any):</label>
          <textarea id="other_people" name="other_people" rows="2" placeholder="Names + roles (optional)"></textarea>

          <h3>Site Features</h3>

          <label for="contact_form_needed">Contact form needed?</label>
          <select id="contact_form_needed" name="contact_form_needed" required>
            <option value="" selected disabled>Select one</option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
            <option value="Not sure">Not sure</option>
          </select>

          <label for="media_player_needed">Media player needed?</label>
          <select id="media_player_needed" name="media_player_needed">
            <option value="" selected>Select one (optional)</option>
            <option value="None">None</option>
            <option value="Video">Video</option>
            <option value="Music/Audio">Music/Audio</option>
            <option value="Both">Both</option>
          </select>

          <h3>E-commerce</h3>

          <label for="ecommerce">E-commerce?</label>
          <select id="ecommerce" name="ecommerce" required>
            <option value="" selected disabled>Select one</option>
            <option value="No">No</option>
            <option value="Yes">Yes</option>
            <option value="Not sure">Not sure</option>
          </select>

          <div id="ecom-details" class="sub-section" style="display:none;">
            <label for="pos">POS / platform (if any):</label>
            <input type="text" id="pos" name="pos" placeholder="Square, Shopify, Clover, etc. (optional)" />

            <label for="shipping">Shipping?</label>
            <select id="shipping" name="shipping">
              <option value="" selected>Select one (optional)</option>
              <option value="No">No</option>
              <option value="Yes">Yes</option>
              <option value="Not sure">Not sure</option>
            </select>

            <label for="pickup_addresses">Pick up address(es):</label>
            <textarea id="pickup_addresses" name="pickup_addresses" rows="3" placeholder="If offering pickup (optional)"></textarea>

            <label for="deals">Deals / bulk discounts / special offers:</label>
            <textarea id="deals" name="deals" rows="3" placeholder="Optional"></textarea>
          </div>

          <h3>Domain</h3>

          <label for="own_domain">Do you already own a domain?</label>
          <select id="own_domain" name="own_domain" required>
            <option value="" selected disabled>Select one</option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
            <option value="Not sure">Not sure</option>
          </select>

          <div id="domain-details" class="sub-section" style="display:none;">
            <label for="domain_name">Domain name (if owned):</label>
            <input type="text" id="domain_name" name="domain_name" placeholder="example.com (optional)" />
          </div>

          <h3>Confirmation</h3>

          <label class="checkbox">
            <input type="checkbox" id="scope_ack" name="scope_ack" required />
            I understand final pricing may change based on the scope outlined above, and work begins after the first invoice is paid.
          </label>

          <button type="submit" id="submit-btn">Submit</button>

          <p class="form-status" id="form-status" aria-live="polite"></p>
        </form>
      </div>
    </div>
  </div>

  <script>
    const FORMSPREE_ENDPOINT = "https://formspree.io/f/mojdbnjd";

    const form = document.getElementById("intake-form");
    const statusEl = document.getElementById("form-status");
    const submitBtn = document.getElementById("submit-btn");

    const ecommerceSelect = document.getElementById("ecommerce");
    const ecomDetails = document.getElementById("ecom-details");

    const ownDomainSelect = document.getElementById("own_domain");
    const domainDetails = document.getElementById("domain-details");

    function toggleEcomDetails() {
      ecomDetails.style.display = (ecommerceSelect.value === "Yes") ? "block" : "none";
    }

    function toggleDomainDetails() {
      domainDetails.style.display = (ownDomainSelect.value === "Yes") ? "block" : "none";
    }

    ecommerceSelect.addEventListener("change", toggleEcomDetails);
    ownDomainSelect.addEventListener("change", toggleDomainDetails);

    // Initialize in case the browser restores prior selections
    toggleEcomDetails();
    toggleDomainDetails();

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      statusEl.textContent = "";

      if (!form.checkValidity()) {
        statusEl.textContent = "Please fill out all required fields.";
        return;
      }

      submitBtn.disabled = true;
      submitBtn.setAttribute("aria-busy", "true");
      statusEl.textContent = "Sending...";

      try {
        const formData = new FormData(form);

        const response = await fetch(FORMSPREE_ENDPOINT, {
          method: "POST",
          body: formData,
          headers: { "Accept": "application/json" }
        });

        if (response.ok) {
          window.location.href = "form_completion.html";
        } else {
          let msg = "Something went wrong. Please try again or contact me directly.";
          try {
            const data = await response.json();
            if (data && data.errors && data.errors.length) {
              msg = data.errors.map(err => err.message).join(" ");
            }
          } catch (_) {}
          statusEl.textContent = msg;
          submitBtn.disabled = false;
          submitBtn.removeAttribute("aria-busy");
        }
      } catch (err) {
        statusEl.textContent = "Network error. Please check your connection and try again.";
        submitBtn.disabled = false;
        submitBtn.removeAttribute("aria-busy");
      }
    });
  </script>
</body>
</html>
